<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>wedge.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Wedge 1.0.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wedge</span></div></div></li><li class="depth-2 branch current"><a href="wedge.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>private</span></div></div></li><li class="depth-3"><a href="wedge.private.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="wedge.core.html#var-call-count"><div class="inner"><span>call-count</span></div></a></li><li class="depth-1"><a href="wedge.core.html#var-called.3F"><div class="inner"><span>called?</span></div></a></li><li class="depth-1"><a href="wedge.core.html#var-total-calls"><div class="inner"><span>total-calls</span></div></a></li><li class="depth-1"><a href="wedge.core.html#var-with-wedge"><div class="inner"><span>with-wedge</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">wedge.core</h2><div class="doc"><pre class="plaintext">Function call verification for use with clojure.test
</pre></div><div class="public anchor" id="var-call-count"><h3>call-count</h3><h4 class="type">macro</h4><div class="usage"><code>(call-count fn-counter search-args)</code></div><div class="doc"><pre class="plaintext">Counts the number of times a fn has been called within a with-wedge binding for a certain set of arguments to the fn.

Example:

;; assume the fn (defn foo [a b] ...) and the following code is inside a (with-wedge [foo foo-counter] ...) binding

(call-count foo-counter [1 2]) ;; counts the number of times (foo 1 2) was called
(call-count foo-counter [? 2]) ;; counts the number of times foo was called with 2 for the &apos;b&apos; parameter. (foo 1 2) and (foo 2 2) would both match
(call-count foo-counter [? ?]) ;; counts the number of times foo was called
(call-count foo-counter [1 [? #(&lt; 1 %)]]) ;; counts the number of times foo was called with the &apos;b&apos; parameter value greater than 1. (foo 1 2) would match but
                                             (foo 1 1) would not

fn-counter  - the counter which tracks the number of times a specific fn is called while within a with-wedge binding
search-args - a vector of arguments matching the fn calls which should be counted. The parameters to the vector can either be the literal values used to call the fn,
              the special form &apos;?&apos; to mean &apos;all argument values&apos;, or the special form &apos;[? predicate]&apos;, where predicate is a fn which takes one argument and returns
              a true or false value indicating if that argument should be included in the fn calls counted.</pre></div><div class="src-link"><a href="http://github.com/clavoie/wedge/blob/master/src/wedge/core.clj#L22">view source</a></div></div><div class="public anchor" id="var-called.3F"><h3>called?</h3><div class="usage"><code>(called? fn-counter)</code></div><div class="doc"><pre class="plaintext">Tests that a fn is called at all, for any set of parameters. Returns true if the fn is called inside the with-wedge binding, and false otherwise

fn-counter - the counter which tracks the number of times a specific fn is called while within a with-wedge binding</pre></div><div class="src-link"><a href="http://github.com/clavoie/wedge/blob/master/src/wedge/core.clj#L6">view source</a></div></div><div class="public anchor" id="var-total-calls"><h3>total-calls</h3><div class="usage"><code>(total-calls fn-counter)</code></div><div class="doc"><pre class="plaintext">Counts all calls to the fn, regardless of the arguments passed to it

fn-counter - the counter which tracks the number of times a specific fn is called while within a with-wedge binding</pre></div><div class="src-link"><a href="http://github.com/clavoie/wedge/blob/master/src/wedge/core.clj#L14">view source</a></div></div><div class="public anchor" id="var-with-wedge"><h3>with-wedge</h3><h4 class="type">macro</h4><div class="usage"><code>(with-wedge bindings &amp; body)</code></div><div class="doc"><pre class="plaintext">Defines a set of bindings to track the number of times a fn is called within the body of with-wedge. Redefs the fns to a shim fn which calls the original fn, counts
the call to the fn, and records with what arguments the fn was called. More than one fn can be tracked at a time within the body of with-wedge. Use wedge.core/call-count
or one of its derrivative fns/macros to count the number of times a fn was called within the body of with-wedge.

Example:

;; assume the fn (defn foo [a b] ...) and (bar [c d] ...)

(deftest foo-tests
  (with-wedge [foo foo-counter bar bar-counter]
    (is (zero? (count-call foo-counter [? ?])))
    ;; etc
  ))

bindings - a vector defining a relationship between a fn which should be tracked and an object which will track the calls to the fn. There must be an even number of symbols in
           the binding vector. The first symbol in the binding vector must be the name of a fn to track calls to, the second symbol in the vector must be a name for the object
           to track the calls to the fn.
body     - the body of the test
</pre></div><div class="src-link"><a href="http://github.com/clavoie/wedge/blob/master/src/wedge/core.clj#L49">view source</a></div></div></div></body></html>